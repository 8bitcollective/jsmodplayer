<!DOCTYPE HTML>
<html>
	<head>
		<script type="text/javascript" src="modfile.js"></script>
		<script type="text/javascript" src="modplayer.js"></script>
		<script type="text/javascript" src="dynamicaudio-min.js"></script>
		
		<script type="text/javascript" src="sundance.mod.js"></script>
		
		<script type="text/javascript">
			var modFile = new ModFile(mod);
			//console.log(modFile);
			var modPlayer = new ModPlayer(modFile, 44100);
			var dynamicAudio;
			
			function init() {
				dynamicAudio = new DynamicAudio({'swf': 'dynamicaudio.swf'});
			}
			
			var playing = false;
			function play() {
				playing = true;
				dynamicAudio.write(modPlayer.getSamples(882000));
				bufferMoreData();
			}
			
			function bufferMoreData() {
				if (playing) {
					dynamicAudio.write(modPlayer.getSamples(88200));
					setTimeout(bufferMoreData, 900);
				}
			}
			
			function stop() {
				playing = false;
			}
		</script>
	</head>
	<body onload="init()">
		<button onclick="play()">play</button>
		<button onclick="stop()">stop</button>
	</body>
</html>
